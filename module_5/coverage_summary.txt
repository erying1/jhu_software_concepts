============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\Eric\Documents\GitHub\jhu_software_concepts\module_5\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\Eric\Documents\GitHub\jhu_software_concepts\module_5
configfile: pytest.ini
testpaths: tests
plugins: anyio-4.12.1, cov-7.0.0
collecting ... collected 202 items

tests/test_analysis_format.py::test_percentages_have_two_decimals PASSED [  0%]
tests/test_analysis_format.py::test_analysis_has_labels PASSED           [  0%]
tests/test_app_init_filters.py::test_pct_filter_exception_handler PASSED [  1%]
tests/test_app_init_filters.py::test_na_filter_empty_string_check PASSED [  1%]
tests/test_buttons.py::test_pull_data_returns_200_when_not_busy PASSED   [  2%]
tests/test_buttons.py::test_update_analysis_returns_200_when_not_busy PASSED [  2%]
tests/test_buttons.py::test_update_analysis_returns_409_when_busy PASSED [  3%]
tests/test_buttons.py::test_pull_data_returns_409_when_busy PASSED       [  3%]
tests/test_clean_fixed.py::test_normalize_status_accepted PASSED         [  4%]
tests/test_clean_fixed.py::test_normalize_status_rejected PASSED         [  4%]
tests/test_clean_fixed.py::test_normalize_status_waitlisted PASSED       [  5%]
tests/test_clean_fixed.py::test_normalize_status_none PASSED             [  5%]
tests/test_clean_fixed.py::test_clean_single_record PASSED               [  6%]
tests/test_clean_fixed.py::test_clean_single_record_handles_invalid_numbers PASSED [  6%]
tests/test_clean_fixed.py::test_clean_single_record_citizenship_american PASSED [  7%]
tests/test_clean_fixed.py::test_clean_single_record_citizenship_other PASSED [  7%]
tests/test_clean_fixed.py::test_clean_data PASSED                        [  8%]
tests/test_clean_fixed.py::test_save_data PASSED                         [  8%]
tests/test_clean_fixed.py::test_load_data PASSED                         [  9%]
tests/test_clean_fixed.py::test_llm_clean_batch_failure_returns_original PASSED [  9%]
tests/test_clean_fixed.py::test_llm_clean_batch_empty_input PASSED       [ 10%]
tests/test_clean_fixed.py::test_clean_data_empty_list PASSED             [ 10%]
tests/test_clean_fixed.py::test_clean_data_save_data_failure PASSED      [ 11%]
tests/test_clean_fixed.py::test_llm_clean_batch_missing_output PASSED    [ 11%]
tests/test_clean_fixed.py::test_llm_clean_batch_cleanup_failure PASSED   [ 12%]
tests/test_clean_fixed.py::test_llm_clean_batch_read_failure PASSED      [ 12%]
tests/test_clean_fixed.py::test_llm_clean_batch_cleanup_exception PASSED [ 13%]
tests/test_clean_remaining_coverage.py::test_llm_clean_batch_successful_cleanup PASSED [ 13%]
tests/test_clean_remaining_coverage.py::test_clean_main_block PASSED     [ 14%]
tests/test_comprehensive_coverage.py::TestAppInit::test_create_app_with_config_dict PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestAppInit::test_create_app_without_config PASSED [ 15%]
tests/test_comprehensive_coverage.py::TestRoutesEdgeCases::test_get_last_pull_file_missing PASSED [ 15%]
tests/test_comprehensive_coverage.py::TestRoutesEdgeCases::test_get_last_runtime_file_missing PASSED [ 16%]
tests/test_comprehensive_coverage.py::TestRoutesEdgeCases::test_load_scraped_records_file_missing PASSED [ 16%]
tests/test_comprehensive_coverage.py::TestRoutesEdgeCases::test_fmt_with_exception PASSED [ 17%]
tests/test_comprehensive_coverage.py::TestRoutesEdgeCases::test_pct_with_exception PASSED [ 17%]
tests/test_comprehensive_coverage.py::TestRoutesEdgeCases::test_na_function PASSED [ 18%]
tests/test_comprehensive_coverage.py::TestRoutesEdgeCases::test_pull_data_subprocess_error_paths PASSED [ 18%]
tests/test_comprehensive_coverage.py::TestCleanEdgeCases::test_normalize_status_variations PASSED [ 19%]
tests/test_comprehensive_coverage.py::TestScrapeEdgeCases::test_parse_row_no_link PASSED [ 19%]
tests/test_comprehensive_coverage.py::TestScrapeEdgeCases::test_parse_detail_empty PASSED [ 20%]
tests/test_comprehensive_coverage.py::TestQueryDataEdgeCases::test_query_with_none_results PASSED [ 20%]
tests/test_comprehensive_coverage.py::TestAdditionalCoverage::test_routes_status_endpoint PASSED [ 21%]
tests/test_comprehensive_coverage.py::TestAdditionalCoverage::test_pull_data_general_exception PASSED [ 21%]
tests/test_comprehensive_coverage.py::test_create_app_applies_test_config PASSED [ 22%]
tests/test_comprehensive_coverage.py::test_create_app_pytest_env_override PASSED [ 22%]
tests/test_comprehensive_coverage.py::test_create_app_all_branches PASSED [ 23%]
tests/test_db_insert.py::test_insert_on_pull_creates_new_rows PASSED     [ 23%]
tests/test_db_insert.py::test_duplicate_rows_not_inserted PASSED         [ 24%]
tests/test_db_insert.py::test_query_function_returns_expected_dict PASSED [ 24%]
tests/test_db_insert.py::test_table_has_required_columns PASSED          [ 25%]
tests/test_final_14_lines.py::test_query_data_format_or_passthrough_string_input PASSED [ 25%]
tests/test_final_14_lines.py::test_load_data_load_json_file_not_found PASSED [ 26%]
tests/test_final_14_lines.py::test_load_data_normalize_record_alternative_keys PASSED [ 26%]
tests/test_final_14_lines.py::test_clean_citizenship_normalization_edge_cases PASSED [ 27%]
tests/test_final_14_lines.py::test_scrape_all_exception_handlers PASSED  [ 27%]
tests/test_final_14_lines.py::test_routes_buggy_exception_handlers SKIPPED [ 28%]
tests/test_flask_page.py::test_analysis_route_exists PASSED              [ 28%]
tests/test_flask_page.py::test_analysis_page_has_buttons PASSED          [ 29%]
tests/test_flask_page.py::test_analysis_page_has_answer_labels PASSED    [ 29%]
tests/test_flask_page.py::test_flask_app_has_required_routes PASSED      [ 30%]
tests/test_integration_end_to_end.py::test_full_pipeline PASSED          [ 30%]
tests/test_integration_end_to_end.py::test_multiple_pulls_maintain_uniqueness PASSED [ 31%]
tests/test_load_data.py::test_load_json_success PASSED                   [ 31%]
tests/test_load_data.py::test_load_json_file_not_found PASSED            [ 32%]
tests/test_load_data.py::test_normalize_record PASSED                    [ 32%]
tests/test_load_data.py::test_normalize_record_with_alternative_keys PASSED [ 33%]
tests/test_load_data.py::test_get_connection PASSED                      [ 33%]
tests/test_load_data.py::test_create_table PASSED                        [ 34%]
tests/test_load_data.py::test_insert_record_new PASSED                   [ 34%]
tests/test_load_data.py::test_insert_record_duplicate PASSED             [ 35%]
tests/test_load_data.py::test_load_into_db PASSED                        [ 35%]
tests/test_load_data.py::test_reset_database PASSED                      [ 36%]
tests/test_load_data.py::test_normalize_record_handles_none_values PASSED [ 36%]
tests/test_load_data_cli_main.py::test_cli_main_default_no_drop PASSED   [ 37%]
tests/test_load_data_cli_main.py::test_cli_main_with_drop_flag PASSED    [ 37%]
tests/test_load_data_database_url.py::test_get_connection_uses_database_url PASSED [ 38%]
tests/test_load_data_fix.py::test_load_json_lines_39_40 PASSED           [ 38%]
tests/test_load_data_fix.py::test_load_json_real_open PASSED             [ 39%]
tests/test_load_data_fix.py::test_main_returns_expected_value PASSED     [ 39%]
tests/test_load_data_main_coverage.py::test_load_data_main_success PASSED [ 40%]
tests/test_load_data_main_coverage.py::test_load_data_main_error PASSED  [ 40%]
tests/test_load_data_main_coverage.py::test_load_data_main_with_drop PASSED [ 41%]
tests/test_max_coverage.py::test_create_app_applies_test_config PASSED   [ 41%]
tests/test_max_coverage.py::test_create_app_pytest_env_override PASSED   [ 42%]
tests/test_max_coverage.py::test_analysis_route_exception_before_template PASSED [ 42%]
tests/test_max_coverage.py::test_pull_data_generic_exception_path PASSED [ 43%]
tests/test_max_coverage.py::test_update_analysis_exception_in_try PASSED [ 43%]
tests/test_max_coverage.py::test_status_endpoint_error_handling PASSED   [ 44%]
tests/test_max_coverage.py::test_routes_final_return_path PASSED         [ 44%]
tests/test_max_coverage.py::test_format_or_passthrough_with_float_formatting PASSED [ 45%]
tests/test_max_coverage.py::test_load_json_with_valid_file PASSED        [ 45%]
tests/test_max_coverage.py::test_load_data_main_block_simulation PASSED  [ 46%]
tests/test_max_coverage.py::test_clean_citizenship_international_normalization PASSED [ 46%]
tests/test_max_coverage.py::test_clean_citizenship_other_default PASSED  [ 47%]
tests/test_max_coverage.py::test_clean_main_block_functions PASSED       [ 47%]
tests/test_max_coverage.py::test_scrape_parse_row_with_different_html_structures PASSED [ 48%]
tests/test_max_coverage.py::test_scrape_parse_detail_with_various_fields PASSED [ 48%]
tests/test_max_coverage.py::test_scrape_main_block_functions PASSED      [ 49%]
tests/test_max_coverage.py::test_run_module_imports PASSED               [ 49%]
tests/test_missing_coverage.py::test_get_all_results_includes_timestamp PASSED [ 50%]
tests/test_missing_coverage.py::test_compute_scraper_diagnostics_with_complete_records PASSED [ 50%]
tests/test_missing_coverage.py::test_compute_scraper_diagnostics_with_missing_fields PASSED [ 50%]
tests/test_missing_coverage.py::test_ensure_table_exists_creates_table PASSED [ 51%]
tests/test_missing_coverage.py::test_get_connection_calls_ensure_table PASSED [ 51%]
tests/test_pages.py::test_render_analysis_page PASSED                    [ 52%]
tests/test_query_and_run_coverage.py::test_format_or_passthrough_exception_handling PASSED [ 52%]
tests/test_query_and_run_coverage.py::test_format_or_passthrough_normal_float_formatting PASSED [ 53%]
tests/test_query_and_run_coverage.py::test_run_module_app_exists PASSED  [ 53%]
tests/test_query_and_run_coverage.py::test_run_main_block_simulation PASSED [ 54%]
tests/test_query_and_run_coverage.py::test_run_app_has_run_method PASSED [ 54%]
tests/test_query_and_run_coverage.py::test_load_data_main PASSED         [ 55%]
tests/test_query_and_run_coverage.py::test_run_main_direct PASSED        [ 55%]
tests/test_query_data.py::test_q4_avg_gpa_american_fall_2026 PASSED      [ 56%]
tests/test_query_data.py::test_q4_avg_gpa_american_fall_2026_none PASSED [ 56%]
tests/test_query_data.py::test_q5_percent_accept_fall_2026 PASSED        [ 57%]
tests/test_query_data.py::test_q5_percent_accept_fall_2026_none PASSED   [ 57%]
tests/test_query_data.py::test_q6_avg_gpa_accept_fall_2026 PASSED        [ 58%]
tests/test_query_data.py::test_q6_avg_gpa_accept_fall_2026_none PASSED   [ 58%]
tests/test_query_data.py::test_q7_jhu_cs_masters_count PASSED            [ 59%]
tests/test_query_data.py::test_q7_jhu_cs_masters_count_none PASSED       [ 59%]
tests/test_query_data.py::test_q8_elite_cs_phd_accepts_2026 PASSED       [ 60%]
tests/test_query_data.py::test_q8_elite_cs_phd_accepts_2026_none PASSED  [ 60%]
tests/test_query_data.py::test_q9_elite_cs_phd_llm_accepts_2026 PASSED   [ 61%]
tests/test_query_data.py::test_q9_elite_cs_phd_llm_accepts_2026_none PASSED [ 61%]
tests/test_query_data.py::test_q10_custom PASSED                         [ 62%]
tests/test_query_data.py::test_q11_custom PASSED                         [ 62%]
tests/test_query_data.py::test_get_all_analysis PASSED                   [ 63%]
tests/test_routes_additional_coverage.py::test_get_last_pull_and_runtime PASSED [ 63%]
tests/test_routes_additional_coverage.py::test_load_scraped_records_valid PASSED [ 64%]
tests/test_routes_additional_coverage.py::test_analysis_results_list_converted_to_dict PASSED [ 64%]
tests/test_routes_additional_coverage.py::test_update_analysis_json_success PASSED [ 65%]
tests/test_routes_additional_coverage.py::test_pull_data_json_success PASSED [ 65%]
tests/test_routes_additional_coverage.py::test_analysis_exception_before_render PASSED [ 66%]
tests/test_routes_additional_coverage.py::test_pull_data_html_redirect PASSED [ 66%]
tests/test_routes_additional_coverage.py::test_pull_data_subprocess_error PASSED [ 67%]
tests/test_routes_additional_coverage.py::test_pull_data_generic_exception PASSED [ 67%]
tests/test_routes_additional_coverage.py::test_pull_data_timestamp_write_failure PASSED [ 68%]
tests/test_routes_additional_coverage.py::test_update_analysis_html_render PASSED [ 68%]
tests/test_routes_additional_coverage.py::test_status_exception PASSED   [ 69%]
tests/test_routes_final_coverage.py::test_pct_none_returns_na PASSED     [ 69%]
tests/test_routes_final_coverage.py::test_pull_data_busy_json_response PASSED [ 70%]
tests/test_routes_final_coverage.py::test_update_analysis_busy_html_redirect PASSED [ 70%]
tests/test_run.py::test_run_py_imports PASSED                            [ 71%]
tests/test_run.py::test_flask_app_exists PASSED                          [ 71%]
tests/test_run_main_exec.py::test_run_main PASSED                        [ 72%]
tests/test_scrape.py::test_get_opener PASSED                             [ 72%]
tests/test_scrape.py::test_check_robots_allowed PASSED                   [ 73%]
tests/test_scrape.py::test_check_robots_disallowed PASSED                [ 73%]
tests/test_scrape.py::test_get_html_success PASSED                       [ 74%]
tests/test_scrape.py::test_get_html_failure PASSED                       [ 74%]
tests/test_scrape.py::test_parse_row_valid PASSED                        [ 75%]
tests/test_scrape.py::test_parse_row_no_link PASSED                      [ 75%]
tests/test_scrape.py::test_parse_row_insufficient_columns PASSED         [ 76%]
tests/test_scrape.py::test_parse_detail_page_html PASSED                 [ 76%]
tests/test_scrape.py::test_parse_detail_page_empty_html PASSED           [ 77%]
tests/test_scrape.py::test_parse_detail_page_html_no_url PASSED          [ 77%]
tests/test_scrape.py::test_fetch_detail_batch PASSED                     [ 78%]
tests/test_scrape.py::test_scrape_data_basic PASSED                      [ 78%]
tests/test_scrape.py::test_parse_detail_gre_total_calculation PASSED     [ 79%]
tests/test_scrape_cli_main.py::test_cli_main_success PASSED              [ 79%]
tests/test_scrape_cli_main.py::test_cli_main_keyboard_interrupt PASSED   [ 80%]
tests/test_scrape_cli_main.py::test_cli_main_exception PASSED            [ 80%]
tests/test_scrape_comphrehensive.py::test_get_html_with_string_data PASSED [ 81%]
tests/test_scrape_comphrehensive.py::test_parse_detail_gpa_exception_handling PASSED [ 81%]
tests/test_scrape_comphrehensive.py::test_parse_detail_american_citizenship PASSED [ 82%]
tests/test_scrape_comphrehensive.py::test_parse_detail_gre_verbal_exception PASSED [ 82%]
tests/test_scrape_comphrehensive.py::test_parse_detail_gre_quant_exception PASSED [ 83%]
tests/test_scrape_comphrehensive.py::test_parse_detail_gre_aw_exception PASSED [ 83%]
tests/test_scrape_comphrehensive.py::test_parse_detail_general_exception PASSED [ 84%]
tests/test_scrape_comphrehensive.py::test_parse_row_waitlisted_normalization PASSED [ 84%]
tests/test_scrape_comphrehensive.py::test_parse_row_status_without_date PASSED [ 85%]
tests/test_scrape_comphrehensive.py::test_fetch_detail_batch_progress_update PASSED [ 85%]
tests/test_scrape_comphrehensive.py::test_scrape_data_no_rows_breaks_loop PASSED [ 86%]
tests/test_scrape_comphrehensive.py::test_scrape_data_sample_printing PASSED [ 86%]
tests/test_scrape_comphrehensive.py::test_parse_detail_gpa_exception PASSED [ 87%]
tests/test_scrape_comphrehensive.py::test_parse_detail_gre_v_exception PASSED [ 87%]
tests/test_scrape_comphrehensive.py::test_parse_detail_gre_q_exception PASSED [ 88%]
tests/test_scrape_comphrehensive.py::test_scrape_data_outer_exception PASSED [ 88%]
tests/test_scrape_comphrehensive.py::test_scrape_data_break_no_rows PASSED [ 89%]
tests/test_scrape_comphrehensive.py::test_scrape_data_break_no_rows_html PASSED [ 89%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_get_opener_returns_opener PASSED [ 90%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_check_robots_returns_true_when_allowed PASSED [ 90%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_check_robots_with_exception_returns_true PASSED [ 91%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_get_html_with_none_opener PASSED [ 91%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_get_html_with_opener_exception PASSED [ 92%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_get_html_with_opener_success PASSED [ 92%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_parse_row_returns_none_without_link PASSED [ 93%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_parse_row_returns_none_insufficient_columns PASSED [ 93%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_parse_detail_page_html_with_base_url PASSED [ 94%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_parse_detail_page_html_without_base_url PASSED [ 94%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_fetch_detail_batch_with_empty_records PASSED [ 95%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_fetch_detail_batch_with_string_urls PASSED [ 95%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_fetch_detail_batch_with_exceptions PASSED [ 96%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_scrape_data_basic_flow PASSED [ 96%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_scrape_data_no_html_returned PASSED [ 97%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_scrape_data_exception_handling PASSED [ 97%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_parse_detail_gre_total_calculation_with_valid_scores PASSED [ 98%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_parse_detail_gre_total_calculation_with_none PASSED [ 98%]
tests/test_scrape_complete_coverage.py::TestScrapeDetailedCoverage::test_parse_detail_gre_total_calculation_with_missing_scores PASSED [ 99%]
tests/test_scrape_main_coverage.py::test_scrape_main_robots_fail PASSED  [ 99%]
tests/test_scrape_main_coverage.py::test_scrape_main_success PASSED      [100%]

=============================== tests coverage ================================
_______________ coverage: platform win32, python 3.11.9-final-0 _______________

Name                         Stmts   Miss  Cover   Missing
----------------------------------------------------------
src\__init__.py                  2      0   100%
src\app\__init__.py             28      0   100%
src\app\pages.py                10      0   100%
src\app\queries.py              13      0   100%
src\app\routes.py              127      0   100%
src\load_data.py                65      0   100%
src\module_2_1\__init__.py       0      0   100%
src\module_2_1\clean.py        126      0   100%
src\module_2_1\scrape.py       268      0   100%
src\query_data.py              105      0   100%
src\run.py                       4      0   100%
----------------------------------------------------------
TOTAL                          748      0   100%
Required test coverage of 100% reached. Total coverage: 100.00%
======================= 201 passed, 1 skipped in 1.67s ========================
